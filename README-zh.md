# React Custom SSR

ä¸€ä¸ªåŸºäº React çš„è‡ªå®šä¹‰æœåŠ¡ç«¯æ¸²æŸ“ (SSR) åº”ç”¨ï¼Œæ”¯æŒæµå¼æ¸²æŸ“ã€ä»£ç åˆ†å‰²å’Œçƒ­æ¨¡å—æ›¿æ¢ã€‚

[English Documentation](./README.md)

## âœ¨ ç‰¹æ€§

- ğŸš€ **æœåŠ¡ç«¯æ¸²æŸ“ (SSR)** - ä½¿ç”¨ React 18 çš„æµå¼æ¸²æŸ“èƒ½åŠ›
- ğŸ“¦ **ä»£ç åˆ†å‰²** - åŸºäº @loadable/component çš„åŠ¨æ€å¯¼å…¥
- ğŸ”¥ **çƒ­æ¨¡å—æ›¿æ¢ (HMR)** - å¼€å‘ç¯å¢ƒä¸‹çš„å®æ—¶æ›´æ–°
- âš¡ **Webpack 5** - ç°ä»£åŒ–çš„æ„å»ºå·¥å…·é“¾
- ğŸ¯ **TypeScript** - å®Œæ•´çš„ç±»å‹æ”¯æŒ
- ğŸŒ **Koa.js** - è½»é‡çº§çš„æœåŠ¡ç«¯æ¡†æ¶
- ğŸ¨ **CSS æ”¯æŒ** - æ”¯æŒ CSS æ–‡ä»¶å’Œæ ·å¼æå–

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- React 18
- TypeScript
- React Router v6
- @loadable/component (ä»£ç åˆ†å‰²)

### åç«¯
- Koa.js
- @koa/router
- @loadable/server

### æ„å»ºå·¥å…·
- Webpack 5
- Babel
- CSS Loader & Mini CSS Extract Plugin

## ğŸ“¦ å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd react-custom-ssr

# å®‰è£…ä¾èµ– (æ¨èä½¿ç”¨ pnpm)
pnpm install

# æˆ–ä½¿ç”¨ npm
npm install
```

## ğŸš€ ä½¿ç”¨

### å¼€å‘ç¯å¢ƒ

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
# æˆ–
pnpm dev
```

å¼€å‘æœåŠ¡å™¨å°†å¯åŠ¨ä¸¤ä¸ªæœåŠ¡ï¼š
- **SSR æœåŠ¡å™¨**: http://localhost:3000 (ä¸»åº”ç”¨)
- **HMR æœåŠ¡å™¨**: http://localhost:8099 (çƒ­æ›´æ–°èµ„æºæœåŠ¡)

### ç”Ÿäº§æ„å»º

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
# æˆ–
pnpm build
```

### æ¸…ç†æ„å»ºæ–‡ä»¶

```bash
# æ¸…ç† build ç›®å½•
npm run clean
# æˆ–
pnpm clean
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
react-custom-ssr/
â”œâ”€â”€ app/                    # åº”ç”¨ä»£ç 
â”‚   â”œâ”€â”€ client/             # å®¢æˆ·ç«¯å…¥å£
â”‚   â”‚   â””â”€â”€ index.tsx       # å®¢æˆ·ç«¯æ°´åˆä»£ç 
â”‚   â””â”€â”€ server/             # æœåŠ¡ç«¯ä»£ç 
â”‚       â”œâ”€â”€ index.tsx       # SSR æœåŠ¡å™¨
â”‚       â”œâ”€â”€ html.ts         # HTML æ¨¡æ¿ç”Ÿæˆ
â”‚       â””â”€â”€ stream.ts       # æµå¼æ¸²æŸ“é€»è¾‘
â”œâ”€â”€ config/                 # æ„å»ºé…ç½®
â”‚   â”œâ”€â”€ constants.js        # å¸¸é‡é…ç½®
â”‚   â”œâ”€â”€ webpack.config.js   # Webpack åŸºç¡€é…ç½®
â”‚   â”œâ”€â”€ webpack.dev.js      # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ webpack.prod.js     # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ scripts/                # è„šæœ¬æ–‡ä»¶
â”‚   â””â”€â”€ dev.js              # å¼€å‘æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”œâ”€â”€ src/                    # æºä»£ç 
â”‚   â”œâ”€â”€ App.tsx             # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â””â”€â”€ App.css             # åº”ç”¨æ ·å¼
â””â”€â”€ build/                  # æ„å»ºè¾“å‡ºç›®å½•
    â”œâ”€â”€ client/             # å®¢æˆ·ç«¯æ„å»ºæ–‡ä»¶
    â”œâ”€â”€ server.js           # æœåŠ¡ç«¯æ„å»ºæ–‡ä»¶
    â””â”€â”€ loadable-stats.json # ä»£ç åˆ†å‰²ç»Ÿè®¡æ–‡ä»¶
```

## âš™ï¸ é…ç½®è¯´æ˜

### TypeScript é…ç½®

é¡¹ç›®åŒ…å«ä¸‰ä¸ª TypeScript é…ç½®æ–‡ä»¶ï¼š
- `tsconfig.json` - åŸºç¡€é…ç½®
- `tsconfig.client.json` - å®¢æˆ·ç«¯ç‰¹å®šé…ç½®
- `tsconfig.server.json` - æœåŠ¡ç«¯ç‰¹å®šé…ç½®

### Webpack é…ç½®

- **å¼€å‘ç¯å¢ƒ**: å¯ç”¨ HMRï¼Œä»£ç†é™æ€èµ„æºåˆ°å¼€å‘æœåŠ¡å™¨
- **ç”Ÿäº§ç¯å¢ƒ**: ä»£ç å‹ç¼©ï¼ŒCSS æå–ï¼Œä¼˜åŒ–æ‰“åŒ…

### ç¯å¢ƒå˜é‡

- `NODE_ENV` - è¿è¡Œç¯å¢ƒ (development/production)
- `PORT` - æœåŠ¡å™¨ç«¯å£ (é»˜è®¤: 3000)

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### æœåŠ¡ç«¯æ¸²æŸ“ (SSR)

åº”ç”¨ä½¿ç”¨ React 18 çš„ `renderToPipeableStream` API å®ç°æµå¼æ¸²æŸ“ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒå’Œæ€§èƒ½ã€‚

### ä»£ç åˆ†å‰²

é€šè¿‡ `@loadable/component` å®ç°ç»„ä»¶çº§åˆ«çš„ä»£ç åˆ†å‰²ï¼Œå‡å°‘åˆå§‹åŒ…å¤§å°ã€‚

### çƒ­æ¨¡å—æ›¿æ¢ (HMR)

å¼€å‘ç¯å¢ƒä¸‹æ”¯æŒçƒ­æ¨¡å—æ›¿æ¢ï¼Œä¿®æ”¹ä»£ç åæ— éœ€åˆ·æ–°é¡µé¢å³å¯çœ‹åˆ°æ›´æ–°ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

